package view;


import java.io.BufferedReader;
import java.io.PrintWriter;
import java.util.HashMap;
import java.util.Iterator;

import allCommands.Command;

public class CLI extends Thread {
	
	private static final String EXIT_COMMAND = "exit";
	
	BufferedReader in;
	PrintWriter out;
	
	View v;
	
	private HashMap<String, Command> commandMap;
	
	//------------------------------Constructors-------------------------//
	
	
	/**
	 * <h1>CLI</h1><p>
	 * <i><ul>CLI(	BufferedReader in, PrintWriter out, HashMap<String,Command> map)<i><p>
	 * Initialize a CLI.
	 * @param in -  BufferedReader
	 * @param out - PrintWriter
	 * @param map - HashMap<String,Command>
	 */
	public CLI(	BufferedReader in, PrintWriter out,View v, HashMap<String,Command> map) {
		this.in = in;
		this.out = out;
		this.v = v;
		this.commandMap = map;
		
	}
	
	//-----------------------------setters and getters-------------------//

	public BufferedReader getIn() {
		return in;
	}

	public void setIn(BufferedReader in) {
		this.in = in;
	}

	public PrintWriter getOut() {
		return out;
	}

	public void setOut(PrintWriter out) {
		this.out = out;
	}

	public HashMap<String, Command> getCommandMap() {
		return commandMap;
	}

	public void setCommandMap(HashMap<String, Command> commandMap) {
		this.commandMap = commandMap;
	}
	
	//-------------------------Functionality-------------------------//
	
	
	
	
	@Override
	public void start() {
		printMenu();
		out.printf("Please enter command: ");
		String buffer;
		boolean flag=false;
		try { 
			while(!(buffer=in.readLine()).equals(EXIT_COMMAND)){
				
				
				Iterator<String> iter = commandMap.keySet().iterator();
				
				while (iter.hasNext()){
					String command = iter.next();
					if(buffer.matches(command)){
						v.forwardCommand(command, buffer.split(" "));
						flag=true;
						continue;
					}
				}
				if(flag == false){
					out.println("\n\nCommand "+ buffer +" not found");
					
				}
				out.printf("\nPlease enter command: ");
			}
			//Add exit function

		}catch (Exception e) {
			e.printStackTrace();
		}



	}
	
	
	public void printMenu(){
		
		StringBuilder sb = new StringBuilder();
		sb.append("*********************************************************************\n");
		sb.append("*                               CLI Menu                            *\n");
		sb.append("*********************************************************************\n");
		sb.append("1) To view file in directory enter: dir <path>\n");
		sb.append("2) To generate new Maze3D enter: generate_maze <name> <other params>\n");
		sb.append("3) To display a Maze3d enter: display <name>\n");
		sb.append("4) To dispaly cross section of the Maze3D enter: display cross section <index{xz,x,y} <name>\n");
		sb.append("5) To display a Maze3d enter: display <name>\n");
		sb.append("6) To save a Maze3D enter: save maze <name> <file name>\n");
		sb.append("7) To load saved Maze3D enter: load maze <file name> <name>\n");
		sb.append("8) To solve a Maze3D enter: solve <name> <algorithm(BFS,DFS)>\n");
		sb.append("9) To display the solution path of the maze enter: display_solution <name>\n");
		sb.append("10) To display the menu enter: display menu\n");
		sb.append("11) To exit enter: exit\n");
	
	}
	
	
	public void displaySolution(String solution){
			out.println(solution);
		
		
	}
	

}
